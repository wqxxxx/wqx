import{r as e,g as t,z as a,n as s,J as o,P as r,o as i,c as u,w as l,a as n,b as d,t as g,j as c,i as f,ab as m,aa as h,E as p,G as b,f as w}from"./index.43beff3c.js";import{r as x,_ as k}from"./gui-page.6784618e.js";import{_}from"./plugin-vue_export-helper.21dcd24c.js";var D=_({data:()=>({fontnum:0,formData:{workCourse:"",workPeriods:"",workStudent:"",workImage:"",workDescribe:""},course:["请选择"],courseIndex:0,student:["请选择"],studentIndex:0,periods:["请选择"],periodsIndex:0,total:""}),methods:{sumfontnum(e){this.fontnum=e.detail.value.length},getCourse(){e({url:`${t().globalData.baseUrl}/yuecheng/course/listAll`,method:"GET",success:e=>{let t=e.data.rows;this.course=t,this.formData.workCourse=this.course[0].courseName},fail:e=>{console.log(e)}})},courseChange:function(e){this.courseIndex=e.detail.value,this.formData.workCourse=this.course[this.courseIndex].courseName,console.log(this.formData.workCourse)},getPeriods(){e({url:`${t().globalData.baseUrl}/yuecheng/periods/listAll`,method:"GET",success:e=>{let t=e.data.rows;this.periods=t,this.formData.workPeriods=this.periods[0].periodsName,this.getStudent(this.periods[0].periodsId)},fail:e=>{console.log(e)}})},periodsChange:function(e){this.periodsIndex=e.detail.value;let t=this.periodsIndex+1;this.getStudent(t),this.formData.workPeriods=this.periods[this.periodsIndex].periodsName,console.log(this.formData.workPeriods)},getStudent(a){e({url:`${t().globalData.baseUrl}/yuecheng/student/listAll?periodsId=${a}`,method:"GET",success:e=>{let t=e.data.rows;this.student=t,this.formData.workStudent=this.student[0].studentName},fail:e=>{console.log(e)}})},studentChange:function(e){this.studentIndex=e.detail.value,this.formData.workStudent=this.student[this.studentIndex].studentName,console.log(this.formData.workStudent)},submit:function(e){var t=e.detail.value;t.workCourse=this.formData.workCourse,t.workPeriods=this.formData.workPeriods,t.workStudent=this.formData.workStudent,t.workImage=this.formData.workImage,t.workDescribe=this.formData.workDescribe,console.log(t),t.workImage?this.sub():a({title:"请上传作业",icon:"none"})},sub:function(){e({url:`${t().globalData.baseUrl}/yuecheng/work/add`,method:"POST",data:{workCourse:this.formData.workCourse,workPeriods:this.formData.workPeriods,workStudent:this.formData.workStudent,workImage:this.formData.workImage,workDescribe:this.formData.workDescribe},success:e=>{console.log(e),200==e.data.code?a({title:"提交成功",icon:"none",duration:2e3,complete:function(e){s({url:"school"})}}):a({title:e.data.msg,icon:"none"})},fail:e=>{console.log(e)}})},chooseImg:function(){o({success:e=>{const a=e.tempFilePaths;r({url:`${t().globalData.baseUrl}/yuecheng/interflow/image`,method:"POST",filePath:a[0],name:"file",success:e=>{let a=JSON.parse(e.data).data[0].url,s=a.split("/"),o=s[s.length-1];this.total=o,console.log(o),this.formData.workImage=`${t().globalData.baseUrl}`+a}})}})}},onLoad(){this.getCourse(),this.getPeriods()}},[["render",function(e,t,a,s,o,r){const _=c,D=f,y=m,I=h,C=p,S=b,P=x(w("gui-page"),k);return i(),u(P,null,{gBody:l((()=>[n(D,null,{default:l((()=>[n(S,{onSubmit:r.submit},{default:l((()=>[n(D,{class:"gui-margin-top gui-padding-x"},{default:l((()=>[n(_,{class:"gui-h6 gui-secondary-text"})])),_:1}),n(D,{style:{height:"28rpx"}}),n(D,{class:"gui-bg-white gui-dark-bg-level-3 gui-padding-x"},{default:l((()=>[n(D,{class:"gui-form-item gui-border-b"},{default:l((()=>[n(_,{class:"gui-form-label gui-secondary-text"},{default:l((()=>[d("课程选择")])),_:1}),n(y,{mode:"selector",range:o.course,"range-key":"courseName",onChange:r.courseChange,value:o.courseIndex},{default:l((()=>[n(D,{class:"gui-flex gui-row gui-nowrap gui-space-between gui-align-items-center"},{default:l((()=>[n(_,{class:"gui-text gui-secondary-text"},{default:l((()=>[d(g(o.course[o.courseIndex].courseName),1)])),_:1}),n(_,{class:"gui-form-icon gui-icons gui-text-center gui-color-gray"},{default:l((()=>[d("")])),_:1})])),_:1})])),_:1},8,["range","onChange","value"])])),_:1}),n(D,{class:"gui-form-item gui-border-b"},{default:l((()=>[n(_,{class:"gui-form-label gui-secondary-text"},{default:l((()=>[d("作业期数")])),_:1}),n(y,{mode:"selector",range:o.periods,"range-key":"periodsName",onChange:r.periodsChange},{default:l((()=>[n(D,{class:"gui-flex gui-row gui-nowrap gui-space-between gui-align-items-center"},{default:l((()=>[n(_,{class:"gui-text gui-secondary-text"},{default:l((()=>[d(g(o.periods[o.periodsIndex].periodsName),1)])),_:1}),n(_,{class:"gui-form-icon gui-icons gui-text-center gui-color-gray"},{default:l((()=>[d("")])),_:1})])),_:1})])),_:1},8,["range","onChange"])])),_:1}),n(D,{class:"gui-form-item gui-border-b"},{default:l((()=>[n(_,{class:"gui-form-label gui-secondary-text"},{default:l((()=>[d("学员选择")])),_:1}),n(y,{mode:"selector",range:o.student,"range-key":"studentName",onChange:r.studentChange},{default:l((()=>[n(D,{class:"gui-flex gui-row gui-nowrap gui-space-between gui-align-items-center"},{default:l((()=>[n(_,{class:"gui-text gui-secondary-text"},{default:l((()=>[d(g(o.student[o.studentIndex].studentName),1)])),_:1}),n(_,{class:"gui-form-icon gui-icons gui-text-center gui-color-gray"},{default:l((()=>[d("")])),_:1})])),_:1})])),_:1},8,["range","onChange"])])),_:1}),n(D,{class:"gui-form-item gui-border-b"},{default:l((()=>[n(_,{class:"gui-form-label gui-secondary-text"},{default:l((()=>[d("作业上传")])),_:1}),n(D,{class:"gui-margin-top gui-bg-gray gui-text-center refer",onClick:r.chooseImg},{default:l((()=>[n(_,{class:"gui-text-small gui-color-blue"},{default:l((()=>[d("点击这里选择文件")])),_:1}),n(_,{class:"totalname"},{default:l((()=>[d(g(o.total),1)])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),n(D,{class:"gui-margin-top gui-padding-x"},{default:l((()=>[n(_,{class:"gui-h6 gui-secondary-text",style:{height:"28rpx"}},{default:l((()=>[d("作业描述")])),_:1})])),_:1}),n(D,{style:{height:"28rpx"}}),n(D,{class:"gui-bg-white gui-dark-bg-level-3 gui-padding-x"},{default:l((()=>[n(D,{style:{"padding-top":"8rpx"}},{default:l((()=>[n(_,{class:"gui-text-small gui-color-gray"})])),_:1}),n(D,{style:{padding:"15rpx 0"}},{default:l((()=>[n(I,{modelValue:o.formData.workDescribe,"onUpdate:modelValue":t[0]||(t[0]=e=>o.formData.workDescribe=e),name:"workDescribe",placeholder:"说点什么...",class:"gui-textarea gui-bg-gray gui-dark-bg-level-1 textareasize",maxlength:"500",onInput:r.sumfontnum},null,8,["modelValue","onInput"])])),_:1}),n(D,{class:"fontnumbox"},{default:l((()=>[n(_,null,{default:l((()=>[d("最多输入500个字")])),_:1}),d(" 一一 "),n(_,null,{default:l((()=>[d(g(o.fontnum)+"/500",1)])),_:1})])),_:1})])),_:1}),n(D,{class:"gui-margin-top gui-flex gui-row gui-nowrap gui-justify-content-end gui-padding-x"},{default:l((()=>[n(C,{type:"default",class:"gui-button gui-bg-primary gui-noborder sub",formType:"submit"},{default:l((()=>[n(_,{class:"gui-icons gui-color-white gui-button-text"},{default:l((()=>[d("作业提交")])),_:1})])),_:1})])),_:1}),n(D,{style:{height:"60rpx"}})])),_:1},8,["onSubmit"])])),_:1})])),_:1})}],["__scopeId","data-v-774929f3"]]);export{D as default};
